import{a as L}from"./chunk-AW73V55B.js";import{a as V}from"./chunk-ASO46S4A.js";import{a as j,b as G}from"./chunk-XGOAYSH6.js";import{a as S,c as E}from"./chunk-3O3MEYGU.js";import"./chunk-457EALQY.js";import"./chunk-I7RDOML2.js";import{b as N,c as P,e as d,g as M,h as k,k as F,l as O,m as T,n as R,o as w,p as A,q,s as D,u as B}from"./chunk-NJBGEMB6.js";import{$a as p,Dc as C,Hc as I,Ia as l,Pb as i,Qa as u,Rb as y,Wa as _,nb as m,ob as e,pb as t,qb as s,zb as x}from"./chunk-HNXX6TOF.js";import"./chunk-FDERIQAA.js";function Y(a,r){a&1&&(e(0,"div",30),i(1," Location name is required "),t())}function $(a,r){a&1&&(e(0,"div",30),i(1," Serial number is required "),t())}function X(a,r){a&1&&(e(0,"div",30),i(1," Device type is required "),t())}function Z(a,r){a&1&&(e(0,"div",30),i(1," Status is required "),t())}function U(a,r){a&1&&(e(0,"div",30),i(1," Valid latitude is required "),t())}function H(a,r){a&1&&(e(0,"div",30),i(1," Valid longitude is required "),t())}function J(a,r){a&1&&s(0,"mat-progress-spinner",31)}var z=class a{constructor(r,o,n,c,f){this.fb=r;this.route=o;this.router=n;this.inventory=c;this.snackBar=f;this.initializeForm(),this.itemId=this.route.snapshot.paramMap.get("id"),this.itemId&&(this.isEdit=!0,this.loadItem(this.itemId))}form;isEdit=!1;submitting=!1;itemId=null;initializeForm(){this.form=this.fb.group({locationName:["",[d.required,d.minLength(2)]],serialNumber:["",[d.required,d.minLength(2)]],deviceType:["",d.required],status:["Installed",d.required],latitude:["",[d.required,d.pattern(/^-?([0-8]?[0-9]|90)(\.[0-9]{1,6})?$/)]],longitude:["",[d.required,d.pattern(/^-?([0-9]{1,2}|1[0-7][0-9]|180)(\.[0-9]{1,6})?$/)]],approachRoad:[""],poles:[!1],ecbPresent:[!1],placeholder:[!1]})}loadItem(r){this.inventory.getById(r).subscribe({next:o=>{o&&this.form.patchValue({locationName:o.locationName||"",serialNumber:o.serialNumber||"",deviceType:o.deviceType||"",status:o.status||"Installed",latitude:o.latitude||"",longitude:o.longitude||"",approachRoad:o.approachRoad&&typeof o.approachRoad=="object"?o.approachRoad.name||"":o.approachRoad||"",poles:o.poles||!1,ecbPresent:o.ecbPresent||!1,placeholder:o.placeholder||!1})},error:o=>{console.error("Failed to load item:",o),this.snackBar.open("\u274C Failed to load device details","Close",{duration:3e3,panelClass:["error-snackbar"]})}})}submit(){if(this.form.invalid){this.markFormGroupTouched(),this.snackBar.open("\u26A0\uFE0F Please fill all required fields correctly","Close",{duration:3e3});return}this.submitting=!0;let r={name:this.form.value.locationName,location:this.form.value.locationName,quantity:1,locationName:this.form.value.locationName,serialNumber:this.form.value.serialNumber,deviceType:this.form.value.deviceType,status:this.form.value.status,latitude:String(this.form.value.latitude),longitude:String(this.form.value.longitude),approachRoad:this.form.value.approachRoad||null,poles:!!this.form.value.poles,ecbPresent:!!this.form.value.ecbPresent,placeholder:!!this.form.value.placeholder,description:void 0};(this.isEdit?this.inventory.update(this.itemId,r):this.inventory.create(r)).subscribe({next:()=>{this.submitting=!1,this.snackBar.open(this.isEdit?"\u2705 Device updated successfully!":"\u2705 Device created successfully!","Close",{duration:4e3}),this.router.navigate(["/admin/inventory"])},error:n=>{this.submitting=!1,console.error(n),this.snackBar.open(n.error?.message||"\u274C Error saving device. Try again.","Close",{duration:5e3})}})}markFormGroupTouched(){Object.keys(this.form.controls).forEach(r=>{this.form.controls[r].markAsTouched()})}cancel(){this.form.dirty&&!window.confirm("You have unsaved changes. Are you sure you want to cancel?")||this.router.navigate(["/admin/inventory"])}static \u0275fac=function(o){return new(o||a)(u(D),u(S),u(E),u(V),u(L))};static \u0275cmp=_({type:a,selectors:[["app-item-form"]],decls:70,vars:12,consts:[[1,"item-form"],[3,"ngSubmit","formGroup"],["formControlName","locationName","placeholder","Enter location name"],["class","error",4,"ngIf"],["formControlName","serialNumber","placeholder","Enter serial number"],["formControlName","deviceType"],["value","","disabled",""],["value","ANPR"],["value","RLVD"],["value","PTZ"],["value","FIXED"],["value","ANALYTICAL"],["formControlName","status"],["value","Installed"],["value","Active"],["value","Inactive"],["value","Maintenance"],[1,"coordinates-group"],["formControlName","latitude","placeholder","e.g., 28.6139","type","number","step","any"],["formControlName","longitude","placeholder","e.g., 77.2090","type","number","step","any"],["formControlName","approachRoad","placeholder","Enter approach road"],[1,"checkbox-group"],[1,"checkbox"],["type","checkbox","formControlName","poles"],["type","checkbox","formControlName","ecbPresent"],["type","checkbox","formControlName","placeholder"],[1,"buttons"],["type","submit",1,"btn","primary",3,"disabled"],["diameter","16","mode","indeterminate","color","white","class","spinner",4,"ngIf"],["type","button",1,"btn","secondary",3,"click","disabled"],[1,"error"],["diameter","16","mode","indeterminate","color","white",1,"spinner"]],template:function(o,n){if(o&1&&(e(0,"div",0)(1,"h2"),i(2),t(),e(3,"form",1),x("ngSubmit",function(){return n.submit()}),e(4,"label"),i(5," Location Name "),s(6,"input",2),p(7,Y,2,0,"div",3),t(),e(8,"label"),i(9," Serial Number "),s(10,"input",4),p(11,$,2,0,"div",3),t(),e(12,"label"),i(13," Device Type "),e(14,"select",5)(15,"option",6),i(16,"Select device type"),t(),e(17,"option",7),i(18,"ANPR"),t(),e(19,"option",8),i(20,"RLVD"),t(),e(21,"option",9),i(22,"PTZ"),t(),e(23,"option",10),i(24,"FIXED"),t(),e(25,"option",11),i(26,"ANALYTICAL"),t()(),p(27,X,2,0,"div",3),t(),e(28,"label"),i(29," Status "),e(30,"select",12)(31,"option",6),i(32,"Select status"),t(),e(33,"option",13),i(34,"Installed"),t(),e(35,"option",14),i(36,"Active"),t(),e(37,"option",15),i(38,"Inactive"),t(),e(39,"option",16),i(40,"Maintenance"),t()(),p(41,Z,2,0,"div",3),t(),e(42,"div",17)(43,"label"),i(44," Latitude "),s(45,"input",18),p(46,U,2,0,"div",3),t(),e(47,"label"),i(48," Longitude "),s(49,"input",19),p(50,H,2,0,"div",3),t()(),e(51,"label"),i(52," Approach Road "),s(53,"input",20),t(),e(54,"div",21)(55,"label",22),s(56,"input",23),i(57," Poles Installed "),t(),e(58,"label",22),s(59,"input",24),i(60," ECB Present "),t(),e(61,"label",22),s(62,"input",25),i(63," Placeholder Device "),t()(),e(64,"div",26)(65,"button",27),p(66,J,1,0,"mat-progress-spinner",28),i(67),t(),e(68,"button",29),x("click",function(){return n.cancel()}),i(69," Cancel "),t()()()()),o&2){let c,f,g,v,b,h;l(2),y("",n.isEdit?"Edit":"Create"," Device"),l(),m("formGroup",n.form),l(4),m("ngIf",((c=n.form.get("locationName"))==null?null:c.invalid)&&((c=n.form.get("locationName"))==null?null:c.touched)),l(4),m("ngIf",((f=n.form.get("serialNumber"))==null?null:f.invalid)&&((f=n.form.get("serialNumber"))==null?null:f.touched)),l(16),m("ngIf",((g=n.form.get("deviceType"))==null?null:g.invalid)&&((g=n.form.get("deviceType"))==null?null:g.touched)),l(14),m("ngIf",((v=n.form.get("status"))==null?null:v.invalid)&&((v=n.form.get("status"))==null?null:v.touched)),l(5),m("ngIf",((b=n.form.get("latitude"))==null?null:b.invalid)&&((b=n.form.get("latitude"))==null?null:b.touched)),l(4),m("ngIf",((h=n.form.get("longitude"))==null?null:h.invalid)&&((h=n.form.get("longitude"))==null?null:h.touched)),l(15),m("disabled",n.form.invalid||n.submitting),l(),m("ngIf",n.submitting),l(),y(" ",n.isEdit?"Update":"Create"," Device "),l(),m("disabled",n.submitting)}},dependencies:[I,C,B,F,A,q,P,O,N,w,M,k,T,R,G,j],styles:[".item-form[_ngcontent-%COMP%]{max-width:600px;margin:20px auto;padding:30px;background:#fff;border-radius:12px;box-shadow:0 4px 12px #0000001a}h2[_ngcontent-%COMP%]{text-align:center;color:#1976d2;margin-bottom:24px;font-weight:600;font-size:24px}form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}label[_ngcontent-%COMP%]{display:flex;flex-direction:column;font-weight:600;color:#333;font-size:14px}input[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{padding:12px;border:2px solid #e0e0e0;border-radius:8px;font-size:14px;margin-top:6px;transition:border-color .3s ease;background:#fafafa}input[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus{outline:none;border-color:#1976d2;background:#fff}.coordinates-group[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:15px}.checkbox-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px;margin:15px 0;padding:20px;background:#f8f9fa;border-radius:8px;border:1px solid #e9ecef}.checkbox[_ngcontent-%COMP%]{flex-direction:row;align-items:center;gap:10px;font-weight:400;cursor:pointer}.checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{margin:0;width:18px;height:18px;cursor:pointer}.buttons[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:flex-end;margin-top:30px;padding-top:20px;border-top:1px solid #e0e0e0}.btn[_ngcontent-%COMP%]{padding:12px 24px;border-radius:8px;border:none;cursor:pointer;font-size:14px;font-weight:600;transition:all .3s ease;display:flex;align-items:center;gap:8px;min-width:120px;justify-content:center}.btn.primary[_ngcontent-%COMP%]{background-color:#1976d2;color:#fff}.btn.primary[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#1565c0;transform:translateY(-1px);box-shadow:0 4px 8px #1976d24d}.btn.secondary[_ngcontent-%COMP%]{background-color:#f5f5f5;color:#333;border:1px solid #ddd}.btn.secondary[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#e0e0e0}.btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed;transform:none!important}.error[_ngcontent-%COMP%]{color:#d32f2f;font-size:12px;margin-top:4px;font-weight:400}.spinner[_ngcontent-%COMP%]{display:inline-block}@media (max-width: 768px){.item-form[_ngcontent-%COMP%]{margin:10px;padding:20px}.coordinates-group[_ngcontent-%COMP%]{grid-template-columns:1fr}.buttons[_ngcontent-%COMP%]{flex-direction:column}.btn[_ngcontent-%COMP%]{width:100%}}"]})};export{z as ItemFormComponent};

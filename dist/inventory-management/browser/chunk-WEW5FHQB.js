import{a as I}from"./chunk-HKU4MGML.js";import{c as P,d as E,g as R}from"./chunk-3O3MEYGU.js";import{c as k,e as p,g as T,h as A,k as N,m as U,n as V,o as F,p as D,q,s as G,u as j}from"./chunk-NJBGEMB6.js";import{$a as c,Bb as g,Dc as y,Hc as O,Ia as a,Lb as C,Nb as w,Pb as o,Qa as u,Qb as M,Wa as b,dc as S,fa as f,ga as x,nb as l,ob as i,pb as t,qb as d,xb as _,zb as v}from"./chunk-HNXX6TOF.js";import"./chunk-FDERIQAA.js";function J(r,n){r&1&&(i(0,"div",22),o(1," Username is required "),t())}function L(r,n){r&1&&(i(0,"div",22),o(1," Valid email required "),t())}function $(r,n){r&1&&(i(0,"div",22),o(1," Password is required "),t())}function H(r,n){if(r&1&&(i(0,"div",23),o(1),t()),r&2){let e=g(2);w("show",e.showToast),a(),M(e.toastMessage)}}function K(r,n){if(r&1){let e=_();i(0,"div",2),d(1,"div",3),i(2,"div",4)(3,"div",5)(4,"h1",6),o(5,"Admin Registration"),t(),i(6,"form",7),v("ngSubmit",function(){f(e);let m=g();return x(m.submit())}),i(7,"div",8)(8,"label",9),o(9,"Username"),t(),d(10,"input",10),c(11,J,2,0,"div",11),t(),i(12,"div",8)(13,"label",9),o(14,"Email"),t(),d(15,"input",12),c(16,L,2,0,"div",11),t(),i(17,"div",8)(18,"label",9),o(19,"Password"),t(),d(20,"input",13),c(21,$,2,0,"div",11),t(),i(22,"div",8)(23,"label",9),o(24,"Role"),t(),i(25,"select",14)(26,"option",15),o(27,"User"),t(),i(28,"option",16),o(29,"Agency"),t(),i(30,"option",17),o(31,"Admin"),t()()(),i(32,"button",18),o(33,"Register"),t()(),i(34,"div",19),o(35," Already have an account? "),i(36,"a",20),o(37,"Sign in \u2192"),t()(),c(38,H,2,3,"div",21),t()()()}if(r&2){let e=g();a(6),l("formGroup",e.form),a(5),l("ngIf",e.form.controls.username.invalid&&e.form.controls.username.touched),a(5),l("ngIf",e.form.controls.email.invalid&&e.form.controls.email.touched),a(5),l("ngIf",e.form.controls.password.invalid&&e.form.controls.password.touched),a(11),l("disabled",e.form.invalid),a(6),l("ngIf",e.toastMessage)}}function Q(r,n){if(r&1){let e=_();i(0,"div",24)(1,"h2"),o(2,"\u274C Access Denied"),t(),i(3,"p"),o(4,"Only admins can register new users."),t(),i(5,"button",25),v("click",function(){f(e);let m=g();return x(m.router.navigate(["/login"]))}),o(6,"Go to Login"),t()()}}var z=class r{constructor(n,e,s){this.fb=n;this.auth=e;this.router=s;this.form=this.fb.group({username:["",p.required],email:["",[p.required,p.email]],password:["",p.required],role:["user",p.required]})}form;toastMessage="";showToast=!1;isAdmin=!1;ngOnInit(){let n=localStorage.getItem("currentUser");if(n){let e=JSON.parse(n);this.isAdmin=e.role==="ADMIN"}else this.isAdmin=!1;this.isAdmin||setTimeout(()=>this.router.navigate(["/login"]),2e3)}showToastMessage(n){this.toastMessage=n,this.showToast=!0,setTimeout(()=>this.showToast=!1,3e3)}submit(){if(this.form.invalid)return;let n=this.form.value,e=localStorage.getItem("mockUsers"),s=e?JSON.parse(e):[];if(s.some(h=>h.username===n.username||h.email===n.email)){this.showToastMessage("User already exists. Try another username or email.");return}let B={id:`local-${Date.now()}`,username:n.username,email:n.email,password:n.password,role:n.role};s.push(B),localStorage.setItem("mockUsers",JSON.stringify(s)),this.showToastMessage("Registration successful! Redirecting to login..."),setTimeout(()=>{this.router.navigate(["/login"])},1500)}static \u0275fac=function(e){return new(e||r)(u(G),u(I),u(P))};static \u0275cmp=b({type:r,selectors:[["app-register"]],decls:3,vars:2,consts:[["notAllowed",""],["class","signup-wrapper",4,"ngIf","ngIfElse"],[1,"signup-wrapper"],[1,"left-hero"],[1,"signup-panel"],[1,"signup-card"],[1,"title"],[1,"signup-form",3,"ngSubmit","formGroup"],[1,"field"],[1,"label"],["placeholder","Username...","formControlName","username",1,"input"],["class","error",4,"ngIf"],["placeholder","Email address...","type","email","formControlName","email",1,"input"],["placeholder","Password...","type","password","formControlName","password",1,"input"],["formControlName","role",1,"input"],["value","user"],["value","agency"],["value","admin"],["type","submit",1,"signup-btn",3,"disabled"],[1,"signin-link"],["routerLink","/login"],["class","toast",3,"show",4,"ngIf"],[1,"error"],[1,"toast"],[1,"not-allowed"],[1,"back-btn",3,"click"]],template:function(e,s){if(e&1&&c(0,K,39,6,"div",1)(1,Q,7,0,"ng-template",null,0,S),e&2){let m=C(2);l("ngIf",s.isAdmin)("ngIfElse",m)}},dependencies:[O,y,j,N,D,q,k,F,T,A,U,V,R,E],styles:["[_nghost-%COMP%]{display:block}.signup-wrapper[_ngcontent-%COMP%]{display:flex;min-height:80vh}.left-hero[_ngcontent-%COMP%]{flex:1;background-image:url(/scs.jpg);background-size:cover;background-position:center;position:relative;border-radius:8px}.signup-panel[_ngcontent-%COMP%]{width:420px;display:flex;align-items:center;justify-content:center;background:#fff}.signup-card[_ngcontent-%COMP%]{width:360px;padding:32px;box-shadow:0 6px 30px #00000014;border-radius:8px}.title[_ngcontent-%COMP%]{margin:0 0 18px;font-size:28px;font-weight:700;text-align:center;color:#5a00ff}.signup-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:14px}.label[_ngcontent-%COMP%]{font-size:12px;margin-bottom:6px}.input[_ngcontent-%COMP%]{padding:10px 8px;border:none;border-bottom:1px solid #e6e6e6;outline:none;font-size:14px}.input[_ngcontent-%COMP%]:focus{border-bottom-color:#5a00ff}.signup-btn[_ngcontent-%COMP%]{margin-top:6px;padding:12px;border-radius:28px;border:none;color:#fff;background:linear-gradient(90deg,#ff6a88,#5a00ff);cursor:pointer;font-weight:600}.signup-btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.signin-link[_ngcontent-%COMP%]{margin-top:12px;font-size:13px;color:#666;text-align:right}.signin-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#5a00ff;text-decoration:none;font-weight:600}.toast[_ngcontent-%COMP%]{visibility:hidden;opacity:0;transition:opacity .3s;margin-top:12px;background:#333;color:#fff;padding:10px 12px;border-radius:6px;text-align:center}.toast.show[_ngcontent-%COMP%]{visibility:visible;opacity:1}.not-allowed[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:80vh;text-align:center}.not-allowed[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#b71c1c;margin-bottom:10px}.not-allowed[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#555;margin-bottom:20px}.back-btn[_ngcontent-%COMP%]{background:#5a00ff;color:#fff;border:none;padding:10px 20px;border-radius:6px;cursor:pointer;font-weight:600}@media (max-width: 900px){.signup-wrapper[_ngcontent-%COMP%]{flex-direction:column}.left-hero[_ngcontent-%COMP%]{height:240px;width:100%}.signup-panel[_ngcontent-%COMP%]{width:100%}}"]})};export{z as RegisterComponent};

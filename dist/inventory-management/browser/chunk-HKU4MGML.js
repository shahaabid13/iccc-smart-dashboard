import{$ as c,A as i,Nc as u,T as s,X as l,g as a,n}from"./chunk-HNXX6TOF.js";var m=class o{constructor(t){this.http=t;let e=localStorage.getItem("currentUser");e&&this.currentUserSubject.next(JSON.parse(e))}isAgency(){throw new Error("Method not implemented.")}getUserAgency(){throw new Error("Method not implemented.")}getUserRole(){throw new Error("Method not implemented.")}resetPassword(t,e){throw new Error("Method not implemented.")}verifyEmail(t){throw new Error("Method not implemented.")}apiUrl="http://localhost:8080/api/auth";currentUserSubject=new a(null);currentUser$=this.currentUserSubject.asObservable();login(t,e){return this.http.post(`${this.apiUrl}/login`,{username:t,password:e}).pipe(s(r=>{localStorage.setItem("token",r.token),localStorage.setItem("role",r.role),localStorage.setItem("username",r.username);let g={id:r.username,username:r.username,email:`${r.username}@app.local`,role:r.role};this.setCurrentUser(g)}),i(r=>(console.error("Login failed:",r),n(()=>r))))}register(t){return this.http.post(`${this.apiUrl}/create`,t).pipe(s(e=>{e?.token&&this.setToken(e.token),e?.user&&this.setCurrentUser(e.user)}),i(e=>(console.error("Registration error:",e),n(()=>e))))}logout(){localStorage.clear(),this.currentUserSubject.next(null)}setToken(t){localStorage.setItem("token",t)}getToken(){return localStorage.getItem("token")}setRole(t){localStorage.setItem("role",t)}getRole(){return localStorage.getItem("role")}getAgencyName(){return localStorage.getItem("agencyName")}isAuthenticated(){return!!this.getToken()}isAdmin(){return this.getRole()?.toLowerCase()==="admin"}getCurrentUser(){return this.currentUserSubject.value}setCurrentUser(t){localStorage.setItem("currentUser",JSON.stringify(t)),this.currentUserSubject.next(t)}static \u0275fac=function(e){return new(e||o)(c(u))};static \u0275prov=l({token:o,factory:o.\u0275fac,providedIn:"root"})};export{m as a};

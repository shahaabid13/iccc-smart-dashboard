import{b as S}from"./chunk-QZJLICHW.js";import{a as P}from"./chunk-SWU2EWNA.js";import{a as D,b as j}from"./chunk-QNMHJO7J.js";import{a as F,f as O}from"./chunk-WAO5ROTU.js";import{S as k,T}from"./chunk-I7RDOML2.js";import{t as w}from"./chunk-NJBGEMB6.js";import{$ as u,$a as h,$b as v,Bb as C,Bc as E,Dc as y,Hc as I,Ia as l,Nc as U,Pb as a,Qa as g,Rb as M,Wa as b,X as d,fa as f,ga as x,nb as s,ob as r,pb as o,xb as _,zb as c}from"./chunk-HNXX6TOF.js";import"./chunk-FDERIQAA.js";var p=class i{constructor(e){this.http=e}apiUrl="http://localhost:8080/api/excel";upload(e){return this.http.post(`${this.apiUrl}/upload`,e)}static \u0275fac=function(n){return new(n||i)(u(U))};static \u0275prov=d({token:i,factory:i.\u0275fac,providedIn:"root"})};var z=(i,e)=>({success:i,error:e});function B(i,e){if(i&1){let n=_();r(0,"button",7),c("click",function(){f(n);let m=C();return x(m.reset())}),r(1,"mat-icon"),a(2,"refresh"),o(),a(3," Reset "),o()}}var H=class i{constructor(e){this.excel=e}file=null;message="";success=!1;onFile(e){let t=e.target.files?.[0]??null;if(t&&!t.name.toLowerCase().endsWith(".xlsx")){this.message="\u274C Please select a valid .xlsx file",this.file=null,this.success=!1;return}this.file=t,this.message=this.file?`\u2705 Selected: ${this.file.name}`:"",this.success=!0}upload(){if(!this.file)return;let e=new FormData;e.append("file",this.file),this.excel.upload(e).subscribe({next:()=>{this.message="\u2705 Upload successful!",this.success=!0},error:n=>{this.message=`\u274C Upload failed: ${n?.message||"Server error"}`,this.success=!1}})}reset(){this.file=null,this.message="",this.success=!1}static \u0275fac=function(n){return new(n||i)(g(p))};static \u0275cmp=b({type:i,selectors:[["app-excel-upload"]],decls:15,vars:7,consts:[[1,"excel-card","mat-elevation-z4"],[1,"upload-section"],["type","file","accept",".xlsx",3,"change"],[1,"btn-group"],["mat-raised-button","","color","primary",3,"click","disabled"],["mat-raised-button","","color","warn","class","reset-btn",3,"click",4,"ngIf"],[1,"status",3,"ngClass"],["mat-raised-button","","color","warn",1,"reset-btn",3,"click"]],template:function(n,t){n&1&&(r(0,"mat-card",0)(1,"h2")(2,"mat-icon"),a(3,"upload_file"),o(),a(4," Upload Excel File (.xlsx)"),o(),r(5,"div",1)(6,"input",2),c("change",function(N){return t.onFile(N)}),o(),r(7,"div",3)(8,"button",4),c("click",function(){return t.upload()}),r(9,"mat-icon"),a(10,"cloud_upload"),o(),a(11," Upload "),o(),h(12,B,4,0,"button",5),o()(),r(13,"p",6),a(14),o()()),n&2&&(l(8),s("disabled",!t.file),l(4),s("ngIf",t.file),l(),s("ngClass",v(4,z,t.success,!t.success)),l(),M(" ",t.message," "))},dependencies:[I,E,y,w,O,F,P,S,T,k,j,D],styles:[".excel-card[_ngcontent-%COMP%]{margin:30px;padding:24px;border-radius:12px;max-width:480px}h2[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:#3f51b5;margin-bottom:16px;font-weight:600}.upload-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}input[type=file][_ngcontent-%COMP%]{padding:8px;border:1px dashed #90caf9;border-radius:8px;background:#e3f2fd}.btn-group[_ngcontent-%COMP%]{display:flex;gap:10px}.status[_ngcontent-%COMP%]{margin-top:16px;font-weight:500;font-size:15px}.success[_ngcontent-%COMP%]{color:#43a047}.error[_ngcontent-%COMP%]{color:#e53935}.reset-btn[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ef5350,#e53935);color:#fff;transition:all .3s ease;border-radius:6px}.reset-btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);background:linear-gradient(135deg,#e53935,#d32f2f)}"]})};export{H as ExcelUploadComponent};
